//a
MATCH (i:INDIVIDUAL)-[v:VIU]->()
WHERE v.Location="SFLL" AND i.surname<>"nan" AND i.second_surname<>"nan"
WITH DISTINCT v.Year as Year, size(collect(i)) AS Habitants, collect(DISTINCT i.surname) + collect(DISTINCT i.second_surname) AS CognomsRepetits UNWIND CognomsRepetits as Surnames
RETURN Year, Habitants, collect(DISTINCT Surnames) as Cognoms
ORDER BY Year

//b
#uso del indice de texto:
CALL db.index.fulltext.queryNodes('IndividualNameIndex', 'Juan Magan Rodr√≠guez')
YIELD node, score
RETURN id(node), node.name, node.surname, node.second_surname, score;

//c - FUNCIONA
CALL{
    CALL db.index.fulltext.queryNodes('IndividuNomCognoms', 'benito julivert')
    YIELD node, score
    WITH node, score
    ORDER BY score DESC
    RETURN node
    LIMIT 1
} 
WITH node
MATCH (n:INDIVIDUAL)-[f:FAMILIA]-(m:INDIVIDUAL) 
WHERE n = node AND f.Relacio IN ["hija", "hijo"]
RETURN m.name, m.surname, m.second_surname, f.Relacio
ORDER BY m.name
